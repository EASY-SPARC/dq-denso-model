function [A,Bmv] = densoJacobianFunction(x,u)
%DENSOJACOBIANFUNCTION Summary of this function goes here
%   Detailed explanation goes here

theta1 = x(9);
theta2 = x(10);
theta3 = x(11);
theta4 = x(12);
theta5 = x(13);
theta6 = x(14);

%% Position Jacobian (Jp)

Jp = zeros(3,6);

Jp(1,1) = 0.21*sin(theta1)*sin(theta2) + 0.21*cos(theta2)*sin(theta1)*sin(theta3) + 0.21*cos(theta3)*sin(theta1)*sin(theta2) + 0.07*cos(theta1)*sin(theta4)*sin(theta5) - 0.075*sin(theta1)*sin(theta2)*sin(theta3) + 0.075*cos(theta2)*cos(theta3)*sin(theta1) + 0.07*cos(theta2)*cos(theta5)*sin(theta1)*sin(theta3) + 0.07*cos(theta3)*cos(theta5)*sin(theta1)*sin(theta2) + 0.07*cos(theta2)*cos(theta3)*cos(theta4)*sin(theta1)*sin(theta5) - 0.07*cos(theta4)*sin(theta1)*sin(theta2)*sin(theta3)*sin(theta5);
Jp(2,1) = - 0.21*cos(theta1)*sin(theta2) + 0.075*cos(theta1)*sin(theta2)*sin(theta3) + 0.07*sin(theta1)*sin(theta4)*sin(theta5) - 0.075*cos(theta1)*cos(theta2)*cos(theta3) - 0.21*cos(theta1)*cos(theta2)*sin(theta3) - 0.21*cos(theta1)*cos(theta3)*sin(theta2) - 0.07*cos(theta1)*cos(theta2)*cos(theta5)*sin(theta3) - 0.07*cos(theta1)*cos(theta3)*cos(theta5)*sin(theta2) - 0.07*cos(theta1)*cos(theta2)*cos(theta3)*cos(theta4)*sin(theta5) + 0.07*cos(theta1)*cos(theta4)*sin(theta2)*sin(theta3)*sin(theta5);

Jp(1,2) = - 0.1115*cos(theta2 - 1.0*theta1 + theta3 + 0.34302)- 0.00875*cos(theta1 + theta2 + theta3 + theta4 + theta5) - 0.0175*cos(theta1 + theta2 + theta3 - 1.0*theta5) - 0.0175*cos(theta2 - 1.0*theta1 + theta3 + theta5) + 0.00875*cos(theta1 + theta2 + theta3 - 1.0*theta4 - 1.0*theta5) + 0.00875*cos(theta1 - 1.0*theta2 - 1.0*theta3 + theta4 + theta5) + 0.00875*cos(theta2 - 1.0*theta1 + theta3 + theta4 - 1.0*theta5) - 0.00875*cos(theta2 - 1.0*theta1 + theta3 - 1.0*theta4 + theta5) - 0.105*cos(theta1 - 1.0*theta2) - 0.1115*cos(theta1 + theta2 + theta3 + 0.34302)- 0.0175*cos(theta1 + theta2 + theta3 + theta5) + 0.00875*cos(theta1 + theta2 + theta3 + theta4 - 1.0*theta5) - 0.00875*cos(theta1 + theta2 + theta3 - 1.0*theta4 + theta5) - 0.00875*cos(theta2 - 1.0*theta1 + theta3 + theta4 + theta5) - 0.105*cos(theta1 + theta2) - 0.0175*cos(theta1 - 1.0*theta2 - 1.0*theta3 + theta5);
Jp(2,2) = 0.0175*sin(theta2 - 1.0*theta1 + theta3 + theta5) - 0.0175*sin(theta1 + theta2 + theta3 - 1.0*theta5) - 0.00875*sin(theta1 + theta2 + theta3 + theta4 + theta5) + 0.00875*sin(theta1 + theta2 + theta3 - 1.0*theta4 - 1.0*theta5) + 0.00875*sin(theta1 - 1.0*theta2 - 1.0*theta3 + theta4 + theta5) - 0.00875*sin(theta2 - 1.0*theta1 + theta3 + theta4 - 1.0*theta5) + 0.00875*sin(theta2 - 1.0*theta1 + theta3 - 1.0*theta4 + theta5) - 0.105*sin(theta1 - 1.0*theta2) - 0.1115*cos(theta1 + theta2 + theta3 - 1.2278) - 0.0175*sin(theta1 + theta2 + theta3 + theta5) + 0.1115*cos(theta1 - 1.0*theta2 - 1.0*theta3 + 1.2278) + 0.00875*sin(theta1 + theta2 + theta3 + theta4 - 1.0*theta5) - 0.00875*sin(theta1 + theta2 + theta3 - 1.0*theta4 + theta5) + 0.00875*sin(theta2 - 1.0*theta1 + theta3 + theta4 + theta5) - 0.105*sin(theta1 + theta2)- 0.0175*sin(theta1 - 1.0*theta2 - 1.0*theta3 + theta5);
Jp(3,2) = - 0.035*sin(theta2 + theta3 + theta5) + 0.0175*sin(theta2 + theta3 + theta4 - 1.0*theta5) - 0.0175*sin(theta2 + theta3 - 1.0*theta4 + theta5) - 0.0175*sin(theta2 + theta3 + theta4 + theta5) - 0.035*sin(theta2 + theta3 - 1.0*theta5) + 0.0175*sin(theta2 + theta3 - 1.0*theta4 - 1.0*theta5) - 0.21*sin(theta2) - 0.22299*cos(theta2 + theta3 - 1.2278);

Jp(1,3) = - 0.1115*cos(theta2 - 1.0*theta1 + theta3 + 0.34302)- 0.00875*cos(theta1 + theta2 + theta3 + theta4 + theta5) - 0.0175*cos(theta1 + theta2 + theta3 - 1.0*theta5) - 0.0175*cos(theta2 - 1.0*theta1 + theta3 + theta5) + 0.00875*cos(theta1 + theta2 + theta3 - 1.0*theta4 - 1.0*theta5) + 0.00875*cos(theta1 - 1.0*theta2 - 1.0*theta3 + theta4 + theta5) + 0.00875*cos(theta2 - 1.0*theta1 + theta3 + theta4 - 1.0*theta5) - 0.00875*cos(theta2 - 1.0*theta1 + theta3 - 1.0*theta4 + theta5) - 0.1115*cos(theta1 + theta2 + theta3 + 0.34302) - 0.0175*cos(theta1 + theta2 + theta3 + theta5) + 0.00875*cos(theta1 + theta2 + theta3 + theta4 - 1.0*theta5) - 0.00875*cos(theta1 + theta2 + theta3 - 1.0*theta4 + theta5) - 0.00875*cos(theta2 - 1.0*theta1 + theta3 + theta4 + theta5) - 1.0716e-18*cos(theta1 - 1.0*theta2 - 1.0*theta3 + theta4) - 0.0175*cos(theta1 - 1.0*theta2 - 1.0*theta3 + theta5);
Jp(2,3) = 0.0175*sin(theta2 - 1.0*theta1 + theta3 + theta5) - 0.0175*sin(theta1 + theta2 + theta3 - 1.0*theta5) - 0.00875*sin(theta1 + theta2 + theta3 + theta4 + theta5) + 0.00875*sin(theta1 + theta2 + theta3 - 1.0*theta4 - 1.0*theta5) + 0.00875*sin(theta1 - 1.0*theta2 - 1.0*theta3 + theta4 + theta5) - 0.00875*sin(theta2 - 1.0*theta1 + theta3 + theta4 - 1.0*theta5) + 0.00875*sin(theta2 - 1.0*theta1 + theta3 - 1.0*theta4 + theta5) - 0.1115*cos(theta1 + theta2 + theta3 - 1.2278) - 0.0175*sin(theta1 + theta2 + theta3 + theta5) + 0.1115*cos(theta1 - 1.0*theta2 - 1.0*theta3 + 1.2278) + 0.00875*sin(theta1 + theta2 + theta3 + theta4 - 1.0*theta5) - 0.00875*sin(theta1 + theta2 + theta3 - 1.0*theta4 + theta5) + 0.00875*sin(theta2 - 1.0*theta1 + theta3 + theta4 + theta5) - 0.0175*sin(theta1 - 1.0*theta2 - 1.0*theta3 + theta5);
Jp(3,3) = - 0.035*sin(theta2 + theta3 + theta5) + 0.0175*sin(theta2 + theta3 + theta4 - 1.0*theta5) - 0.0175*sin(theta2 + theta3 - 1.0*theta4 + theta5) - 0.0175*sin(theta2 + theta3 + theta4 + theta5) - 0.035*sin(theta2 + theta3 - 1.0*theta5) + 0.0175*sin(theta2 + theta3 - 1.0*theta4 - 1.0*theta5) - 0.22299*cos(theta2 + theta3 - 1.2278);

Jp(1,4) = - 0.0175*cos(theta1 + theta4 + theta5) - 0.00875*cos(theta1 + theta2 + theta3 + theta4 + theta5) - 0.00875*cos(theta1 + theta2 + theta3 - 1.0*theta4 - 1.0*theta5) - 0.00875*cos(theta1 - 1.0*theta2 - 1.0*theta3 + theta4 + theta5) + 0.00875*cos(theta2 - 1.0*theta1 + theta3 + theta4 - 1.0*theta5) + 0.00875*cos(theta2 - 1.0*theta1 + theta3 - 1.0*theta4 + theta5) + 0.00875*cos(theta1 + theta2 + theta3 + theta4 - 1.0*theta5) + 0.00875*cos(theta1 + theta2 + theta3 - 1.0*theta4 + theta5) - 0.00875*cos(theta2 - 1.0*theta1 + theta3 + theta4 + theta5) + 0.0175*cos(theta1 + theta4 - 1.0*theta5) - 0.0175*cos(theta1 - 1.0*theta4 + theta5) + 0.0175*cos(theta4 - 1.0*theta1 + theta5);
Jp(2,4) = - 0.0175*sin(theta1 + theta4 + theta5) - 0.00875*sin(theta1 + theta2 + theta3 + theta4 + theta5) - 0.00875*sin(theta1 + theta2 + theta3 - 1.0*theta4 - 1.0*theta5) - 0.00875*sin(theta1 - 1.0*theta2 - 1.0*theta3 + theta4 + theta5) - 0.00875*sin(theta2 - 1.0*theta1 + theta3 + theta4 - 1.0*theta5) - 0.00875*sin(theta2 - 1.0*theta1 + theta3 - 1.0*theta4 + theta5) + 0.00875*sin(theta1 + theta2 + theta3 + theta4 - 1.0*theta5) + 0.00875*sin(theta1 + theta2 + theta3 - 1.0*theta4 + theta5) + 0.00875*sin(theta2 - 1.0*theta1 + theta3 + theta4 + theta5) + 0.0175*sin(theta1 + theta4 - 1.0*theta5) - 0.0175*sin(theta1 - 1.0*theta4 + theta5) - 0.0175*sin(theta4 - 1.0*theta1 + theta5);
Jp(3,4) = 0.0175*sin(theta2 + theta3 + theta4 - 1.0*theta5) + 0.0175*sin(theta2 + theta3 - 1.0*theta4 + theta5) - 0.0175*sin(theta2 + theta3 + theta4 + theta5) - 0.0175*sin(theta2 + theta3 - 1.0*theta4 - 1.0*theta5);

Jp(1,5) = 0.0175*cos(theta1 + theta2 + theta3 - 1.0*theta5) - 0.0175*cos(theta1 + theta4 + theta5) - 0.00875*cos(theta1 + theta2 + theta3 + theta4 + theta5) - 0.0175*cos(theta2 - 1.0*theta1 + theta3 + theta5) - 0.00875*cos(theta1 + theta2 + theta3 - 1.0*theta4 - 1.0*theta5) - 0.00875*cos(theta1 - 1.0*theta2 - 1.0*theta3 + theta4 + theta5) - 0.00875*cos(theta2 - 1.0*theta1 + theta3 + theta4 - 1.0*theta5) - 0.00875*cos(theta2 - 1.0*theta1 + theta3 - 1.0*theta4 + theta5) - 0.0175*cos(theta1 + theta2 + theta3 + theta5) - 0.00875*cos(theta1 + theta2 + theta3 + theta4 - 1.0*theta5) - 0.00875*cos(theta1 + theta2 + theta3 - 1.0*theta4 + theta5) - 0.00875*cos(theta2 - 1.0*theta1 + theta3 + theta4 + theta5) - 0.0175*cos(theta1 + theta4 - 1.0*theta5) + 0.0175*cos(theta1 - 1.0*theta4 + theta5) + 0.0175*cos(theta4 - 1.0*theta1 + theta5) + 0.0175*cos(theta1 - 1.0*theta2 - 1.0*theta3 + theta5);
Jp(2,5) = 0.0175*sin(theta1 + theta2 + theta3 - 1.0*theta5) - 0.0175*sin(theta1 + theta4 + theta5) - 0.00875*sin(theta1 + theta2 + theta3 + theta4 + theta5) + 0.0175*sin(theta2 - 1.0*theta1 + theta3 + theta5) - 0.00875*sin(theta1 + theta2 + theta3 - 1.0*theta4 - 1.0*theta5) - 0.00875*sin(theta1 - 1.0*theta2 - 1.0*theta3 + theta4 + theta5) + 0.00875*sin(theta2 - 1.0*theta1 + theta3 + theta4 - 1.0*theta5) + 0.00875*sin(theta2 - 1.0*theta1 + theta3 - 1.0*theta4 + theta5) - 0.0175*sin(theta1 + theta2 + theta3 + theta5) - 0.00875*sin(theta1 + theta2 + theta3 + theta4 - 1.0*theta5) - 0.00875*sin(theta1 + theta2 + theta3 - 1.0*theta4 + theta5) + 0.00875*sin(theta2 - 1.0*theta1 + theta3 + theta4 + theta5) - 0.0175*sin(theta1 + theta4 - 1.0*theta5) + 0.0175*sin(theta1 - 1.0*theta4 + theta5) - 0.0175*sin(theta4 - 1.0*theta1 + theta5) + 0.0175*sin(theta1 - 1.0*theta2 - 1.0*theta3 + theta5);
Jp(3,5) = - 0.0175*sin(theta2 + theta3 + theta4 - 1.0*theta5) - 0.0175*sin(theta2 + theta3 - 1.0*theta4 + theta5) - 0.035*sin(theta2 + theta3 + theta5) - 0.0175*sin(theta2 + theta3 + theta4 + theta5) + 0.035*sin(theta2 + theta3 - 1.0*theta5) - 0.0175*sin(theta2 + theta3 - 1.0*theta4 - 1.0*theta5);

Jp = [zeros(1,6);Jp];

%% Primal Jacobian (JP)

JP = zeros(4,6);

JP(1,:) = [ sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + sin(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, sin(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + sin(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8];
JP(2,:) = [ sin(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, sin(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8];
JP(3,:) = [ cos(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, cos(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8];
JP(4,:) = [ cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, cos(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, cos(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, cos(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8];

%% Dual Jacobian (JD)

x_e = zeros(8,1);
x_e(1) = cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/4 - cos(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/4 + cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/4 + cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/4 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/4 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/4 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/4 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/4;
x_e(2) = cos(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/4 + cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/4 + cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/4 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/4 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/4 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/4 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/4 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/4;
x_e(3) = sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/4 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/4 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/4 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/4 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/4 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/4 - sin(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/4 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/4;
x_e(4) = sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/4 - sin(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/4 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/4 + sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/4 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/4 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/4 + sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/4 + sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/4;
x_e(5) = (3*sin(theta1/2)*sin(theta2/2)*sin(theta3/2)*sin(theta4/2)*sin(theta5/2)*sin(theta6/2))/80 - (123*cos(theta1/2)*cos(theta2/2)*cos(theta3/2)*cos(theta4/2)*cos(theta5/2)*sin(theta6/2))/400 - (123*cos(theta1/2)*cos(theta2/2)*cos(theta3/2)*cos(theta5/2)*cos(theta6/2)*sin(theta4/2))/400 - (123*cos(theta2/2)*cos(theta3/2)*cos(theta4/2)*cos(theta5/2)*cos(theta6/2)*sin(theta1/2))/400 - (3*cos(theta1/2)*cos(theta2/2)*cos(theta3/2)*cos(theta4/2)*sin(theta5/2)*sin(theta6/2))/80 + (3*cos(theta1/2)*cos(theta2/2)*cos(theta3/2)*cos(theta6/2)*sin(theta4/2)*sin(theta5/2))/80 + (3*cos(theta1/2)*cos(theta2/2)*cos(theta4/2)*cos(theta5/2)*sin(theta3/2)*sin(theta6/2))/80 + (3*cos(theta1/2)*cos(theta2/2)*cos(theta5/2)*cos(theta6/2)*sin(theta3/2)*sin(theta4/2))/80 + (3*cos(theta1/2)*cos(theta3/2)*cos(theta4/2)*cos(theta5/2)*sin(theta2/2)*sin(theta6/2))/80 + (3*cos(theta1/2)*cos(theta3/2)*cos(theta5/2)*cos(theta6/2)*sin(theta2/2)*sin(theta4/2))/80 - (3*cos(theta2/2)*cos(theta3/2)*cos(theta4/2)*cos(theta6/2)*sin(theta1/2)*sin(theta5/2))/80 + (3*cos(theta2/2)*cos(theta4/2)*cos(theta5/2)*cos(theta6/2)*sin(theta1/2)*sin(theta3/2))/80 + (3*cos(theta3/2)*cos(theta4/2)*cos(theta5/2)*cos(theta6/2)*sin(theta1/2)*sin(theta2/2))/80 + (39*cos(theta1/2)*cos(theta2/2)*cos(theta4/2)*sin(theta3/2)*sin(theta5/2)*sin(theta6/2))/400 - (39*cos(theta1/2)*cos(theta2/2)*cos(theta6/2)*sin(theta3/2)*sin(theta4/2)*sin(theta5/2))/400 - (9*cos(theta1/2)*cos(theta3/2)*cos(theta4/2)*sin(theta2/2)*sin(theta5/2)*sin(theta6/2))/80 + (9*cos(theta1/2)*cos(theta3/2)*cos(theta6/2)*sin(theta2/2)*sin(theta4/2)*sin(theta5/2))/80 + (39*cos(theta1/2)*cos(theta4/2)*cos(theta5/2)*sin(theta2/2)*sin(theta3/2)*sin(theta6/2))/400 + (39*cos(theta1/2)*cos(theta5/2)*cos(theta6/2)*sin(theta2/2)*sin(theta3/2)*sin(theta4/2))/400 + (123*cos(theta2/2)*cos(theta3/2)*cos(theta5/2)*sin(theta1/2)*sin(theta4/2)*sin(theta6/2))/400 + (39*cos(theta2/2)*cos(theta4/2)*cos(theta6/2)*sin(theta1/2)*sin(theta3/2)*sin(theta5/2))/400 - (9*cos(theta3/2)*cos(theta4/2)*cos(theta6/2)*sin(theta1/2)*sin(theta2/2)*sin(theta5/2))/80 + (39*cos(theta4/2)*cos(theta5/2)*cos(theta6/2)*sin(theta1/2)*sin(theta2/2)*sin(theta3/2))/400 + (3*cos(theta1/2)*cos(theta4/2)*sin(theta2/2)*sin(theta3/2)*sin(theta5/2)*sin(theta6/2))/80 - (3*cos(theta1/2)*cos(theta6/2)*sin(theta2/2)*sin(theta3/2)*sin(theta4/2)*sin(theta5/2))/80 - (3*cos(theta2/2)*cos(theta3/2)*sin(theta1/2)*sin(theta4/2)*sin(theta5/2)*sin(theta6/2))/80 - (3*cos(theta2/2)*cos(theta5/2)*sin(theta1/2)*sin(theta3/2)*sin(theta4/2)*sin(theta6/2))/80 - (3*cos(theta3/2)*cos(theta5/2)*sin(theta1/2)*sin(theta2/2)*sin(theta4/2)*sin(theta6/2))/80 + (3*cos(theta4/2)*cos(theta6/2)*sin(theta1/2)*sin(theta2/2)*sin(theta3/2)*sin(theta5/2))/80 + (39*cos(theta2/2)*sin(theta1/2)*sin(theta3/2)*sin(theta4/2)*sin(theta5/2)*sin(theta6/2))/400 - (9*cos(theta3/2)*sin(theta1/2)*sin(theta2/2)*sin(theta4/2)*sin(theta5/2)*sin(theta6/2))/80 - (39*cos(theta5/2)*sin(theta1/2)*sin(theta2/2)*sin(theta3/2)*sin(theta4/2)*sin(theta6/2))/400;
x_e(6) = (19*cos(theta1/2)*cos(theta2/2)*cos(theta3/2)*cos(theta4/2)*cos(theta6/2)*sin(theta5/2))/80 - (3*cos(theta1/2)*cos(theta2/2)*cos(theta3/2)*cos(theta4/2)*cos(theta5/2)*cos(theta6/2))/80 + (11*cos(theta1/2)*cos(theta2/2)*cos(theta4/2)*cos(theta5/2)*cos(theta6/2)*sin(theta3/2))/400 - (73*cos(theta1/2)*cos(theta3/2)*cos(theta4/2)*cos(theta5/2)*cos(theta6/2)*sin(theta2/2))/400 + (3*cos(theta1/2)*cos(theta2/2)*cos(theta3/2)*cos(theta5/2)*sin(theta4/2)*sin(theta6/2))/80 - (3*cos(theta1/2)*cos(theta2/2)*cos(theta4/2)*cos(theta6/2)*sin(theta3/2)*sin(theta5/2))/80 - (3*cos(theta1/2)*cos(theta3/2)*cos(theta4/2)*cos(theta6/2)*sin(theta2/2)*sin(theta5/2))/80 + (3*cos(theta1/2)*cos(theta4/2)*cos(theta5/2)*cos(theta6/2)*sin(theta2/2)*sin(theta3/2))/80 - (3*cos(theta2/2)*cos(theta3/2)*cos(theta4/2)*cos(theta5/2)*sin(theta1/2)*sin(theta6/2))/80 - (3*cos(theta2/2)*cos(theta3/2)*cos(theta5/2)*cos(theta6/2)*sin(theta1/2)*sin(theta4/2))/80 + (19*cos(theta1/2)*cos(theta2/2)*cos(theta3/2)*sin(theta4/2)*sin(theta5/2)*sin(theta6/2))/80 - (11*cos(theta1/2)*cos(theta2/2)*cos(theta5/2)*sin(theta3/2)*sin(theta4/2)*sin(theta6/2))/400 + (73*cos(theta1/2)*cos(theta3/2)*cos(theta5/2)*sin(theta2/2)*sin(theta4/2)*sin(theta6/2))/400 - (11*cos(theta1/2)*cos(theta4/2)*cos(theta6/2)*sin(theta2/2)*sin(theta3/2)*sin(theta5/2))/400 + (19*cos(theta2/2)*cos(theta3/2)*cos(theta4/2)*sin(theta1/2)*sin(theta5/2)*sin(theta6/2))/80 - (19*cos(theta2/2)*cos(theta3/2)*cos(theta6/2)*sin(theta1/2)*sin(theta4/2)*sin(theta5/2))/80 + (11*cos(theta2/2)*cos(theta4/2)*cos(theta5/2)*sin(theta1/2)*sin(theta3/2)*sin(theta6/2))/400 + (11*cos(theta2/2)*cos(theta5/2)*cos(theta6/2)*sin(theta1/2)*sin(theta3/2)*sin(theta4/2))/400 - (73*cos(theta3/2)*cos(theta4/2)*cos(theta5/2)*sin(theta1/2)*sin(theta2/2)*sin(theta6/2))/400 - (73*cos(theta3/2)*cos(theta5/2)*cos(theta6/2)*sin(theta1/2)*sin(theta2/2)*sin(theta4/2))/400 - (3*cos(theta1/2)*cos(theta2/2)*sin(theta3/2)*sin(theta4/2)*sin(theta5/2)*sin(theta6/2))/80 - (3*cos(theta1/2)*cos(theta3/2)*sin(theta2/2)*sin(theta4/2)*sin(theta5/2)*sin(theta6/2))/80 - (3*cos(theta1/2)*cos(theta5/2)*sin(theta2/2)*sin(theta3/2)*sin(theta4/2)*sin(theta6/2))/80 - (3*cos(theta2/2)*cos(theta4/2)*sin(theta1/2)*sin(theta3/2)*sin(theta5/2)*sin(theta6/2))/80 + (3*cos(theta2/2)*cos(theta6/2)*sin(theta1/2)*sin(theta3/2)*sin(theta4/2)*sin(theta5/2))/80 - (3*cos(theta3/2)*cos(theta4/2)*sin(theta1/2)*sin(theta2/2)*sin(theta5/2)*sin(theta6/2))/80 + (3*cos(theta3/2)*cos(theta6/2)*sin(theta1/2)*sin(theta2/2)*sin(theta4/2)*sin(theta5/2))/80 + (3*cos(theta4/2)*cos(theta5/2)*sin(theta1/2)*sin(theta2/2)*sin(theta3/2)*sin(theta6/2))/80 + (3*cos(theta5/2)*cos(theta6/2)*sin(theta1/2)*sin(theta2/2)*sin(theta3/2)*sin(theta4/2))/80 - (11*cos(theta1/2)*sin(theta2/2)*sin(theta3/2)*sin(theta4/2)*sin(theta5/2)*sin(theta6/2))/400 - (11*cos(theta4/2)*sin(theta1/2)*sin(theta2/2)*sin(theta3/2)*sin(theta5/2)*sin(theta6/2))/400 + (11*cos(theta6/2)*sin(theta1/2)*sin(theta2/2)*sin(theta3/2)*sin(theta4/2)*sin(theta5/2))/400;
x_e(7) = (3*cos(theta1/2)*cos(theta2/2)*cos(theta3/2)*cos(theta4/2)*cos(theta5/2)*sin(theta6/2))/80 - (11*sin(theta1/2)*sin(theta2/2)*sin(theta3/2)*sin(theta4/2)*sin(theta5/2)*sin(theta6/2))/400 + (3*cos(theta1/2)*cos(theta2/2)*cos(theta3/2)*cos(theta5/2)*cos(theta6/2)*sin(theta4/2))/80 - (3*cos(theta2/2)*cos(theta3/2)*cos(theta4/2)*cos(theta5/2)*cos(theta6/2)*sin(theta1/2))/80 - (19*cos(theta1/2)*cos(theta2/2)*cos(theta3/2)*cos(theta4/2)*sin(theta5/2)*sin(theta6/2))/80 + (19*cos(theta1/2)*cos(theta2/2)*cos(theta3/2)*cos(theta6/2)*sin(theta4/2)*sin(theta5/2))/80 - (11*cos(theta1/2)*cos(theta2/2)*cos(theta4/2)*cos(theta5/2)*sin(theta3/2)*sin(theta6/2))/400 - (11*cos(theta1/2)*cos(theta2/2)*cos(theta5/2)*cos(theta6/2)*sin(theta3/2)*sin(theta4/2))/400 + (73*cos(theta1/2)*cos(theta3/2)*cos(theta4/2)*cos(theta5/2)*sin(theta2/2)*sin(theta6/2))/400 + (73*cos(theta1/2)*cos(theta3/2)*cos(theta5/2)*cos(theta6/2)*sin(theta2/2)*sin(theta4/2))/400 + (19*cos(theta2/2)*cos(theta3/2)*cos(theta4/2)*cos(theta6/2)*sin(theta1/2)*sin(theta5/2))/80 + (11*cos(theta2/2)*cos(theta4/2)*cos(theta5/2)*cos(theta6/2)*sin(theta1/2)*sin(theta3/2))/400 - (73*cos(theta3/2)*cos(theta4/2)*cos(theta5/2)*cos(theta6/2)*sin(theta1/2)*sin(theta2/2))/400 + (3*cos(theta1/2)*cos(theta2/2)*cos(theta4/2)*sin(theta3/2)*sin(theta5/2)*sin(theta6/2))/80 - (3*cos(theta1/2)*cos(theta2/2)*cos(theta6/2)*sin(theta3/2)*sin(theta4/2)*sin(theta5/2))/80 + (3*cos(theta1/2)*cos(theta3/2)*cos(theta4/2)*sin(theta2/2)*sin(theta5/2)*sin(theta6/2))/80 - (3*cos(theta1/2)*cos(theta3/2)*cos(theta6/2)*sin(theta2/2)*sin(theta4/2)*sin(theta5/2))/80 - (3*cos(theta1/2)*cos(theta4/2)*cos(theta5/2)*sin(theta2/2)*sin(theta3/2)*sin(theta6/2))/80 - (3*cos(theta1/2)*cos(theta5/2)*cos(theta6/2)*sin(theta2/2)*sin(theta3/2)*sin(theta4/2))/80 + (3*cos(theta2/2)*cos(theta3/2)*cos(theta5/2)*sin(theta1/2)*sin(theta4/2)*sin(theta6/2))/80 - (3*cos(theta2/2)*cos(theta4/2)*cos(theta6/2)*sin(theta1/2)*sin(theta3/2)*sin(theta5/2))/80 - (3*cos(theta3/2)*cos(theta4/2)*cos(theta6/2)*sin(theta1/2)*sin(theta2/2)*sin(theta5/2))/80 + (3*cos(theta4/2)*cos(theta5/2)*cos(theta6/2)*sin(theta1/2)*sin(theta2/2)*sin(theta3/2))/80 + (11*cos(theta1/2)*cos(theta4/2)*sin(theta2/2)*sin(theta3/2)*sin(theta5/2)*sin(theta6/2))/400 - (11*cos(theta1/2)*cos(theta6/2)*sin(theta2/2)*sin(theta3/2)*sin(theta4/2)*sin(theta5/2))/400 + (19*cos(theta2/2)*cos(theta3/2)*sin(theta1/2)*sin(theta4/2)*sin(theta5/2)*sin(theta6/2))/80 - (11*cos(theta2/2)*cos(theta5/2)*sin(theta1/2)*sin(theta3/2)*sin(theta4/2)*sin(theta6/2))/400 + (73*cos(theta3/2)*cos(theta5/2)*sin(theta1/2)*sin(theta2/2)*sin(theta4/2)*sin(theta6/2))/400 - (11*cos(theta4/2)*cos(theta6/2)*sin(theta1/2)*sin(theta2/2)*sin(theta3/2)*sin(theta5/2))/400 - (3*cos(theta2/2)*sin(theta1/2)*sin(theta3/2)*sin(theta4/2)*sin(theta5/2)*sin(theta6/2))/80 - (3*cos(theta3/2)*sin(theta1/2)*sin(theta2/2)*sin(theta4/2)*sin(theta5/2)*sin(theta6/2))/80 - (3*cos(theta5/2)*sin(theta1/2)*sin(theta2/2)*sin(theta3/2)*sin(theta4/2)*sin(theta6/2))/80;
x_e(8) = (123*cos(theta1/2)*cos(theta2/2)*cos(theta3/2)*cos(theta4/2)*cos(theta5/2)*cos(theta6/2))/400 + (3*cos(theta1/2)*cos(theta2/2)*cos(theta3/2)*cos(theta4/2)*cos(theta6/2)*sin(theta5/2))/80 - (3*cos(theta1/2)*cos(theta2/2)*cos(theta4/2)*cos(theta5/2)*cos(theta6/2)*sin(theta3/2))/80 - (3*cos(theta1/2)*cos(theta3/2)*cos(theta4/2)*cos(theta5/2)*cos(theta6/2)*sin(theta2/2))/80 - (123*cos(theta1/2)*cos(theta2/2)*cos(theta3/2)*cos(theta5/2)*sin(theta4/2)*sin(theta6/2))/400 - (39*cos(theta1/2)*cos(theta2/2)*cos(theta4/2)*cos(theta6/2)*sin(theta3/2)*sin(theta5/2))/400 + (9*cos(theta1/2)*cos(theta3/2)*cos(theta4/2)*cos(theta6/2)*sin(theta2/2)*sin(theta5/2))/80 - (39*cos(theta1/2)*cos(theta4/2)*cos(theta5/2)*cos(theta6/2)*sin(theta2/2)*sin(theta3/2))/400 - (123*cos(theta2/2)*cos(theta3/2)*cos(theta4/2)*cos(theta5/2)*sin(theta1/2)*sin(theta6/2))/400 - (123*cos(theta2/2)*cos(theta3/2)*cos(theta5/2)*cos(theta6/2)*sin(theta1/2)*sin(theta4/2))/400 + (3*cos(theta1/2)*cos(theta2/2)*cos(theta3/2)*sin(theta4/2)*sin(theta5/2)*sin(theta6/2))/80 + (3*cos(theta1/2)*cos(theta2/2)*cos(theta5/2)*sin(theta3/2)*sin(theta4/2)*sin(theta6/2))/80 + (3*cos(theta1/2)*cos(theta3/2)*cos(theta5/2)*sin(theta2/2)*sin(theta4/2)*sin(theta6/2))/80 - (3*cos(theta1/2)*cos(theta4/2)*cos(theta6/2)*sin(theta2/2)*sin(theta3/2)*sin(theta5/2))/80 - (3*cos(theta2/2)*cos(theta3/2)*cos(theta4/2)*sin(theta1/2)*sin(theta5/2)*sin(theta6/2))/80 + (3*cos(theta2/2)*cos(theta3/2)*cos(theta6/2)*sin(theta1/2)*sin(theta4/2)*sin(theta5/2))/80 + (3*cos(theta2/2)*cos(theta4/2)*cos(theta5/2)*sin(theta1/2)*sin(theta3/2)*sin(theta6/2))/80 + (3*cos(theta2/2)*cos(theta5/2)*cos(theta6/2)*sin(theta1/2)*sin(theta3/2)*sin(theta4/2))/80 + (3*cos(theta3/2)*cos(theta4/2)*cos(theta5/2)*sin(theta1/2)*sin(theta2/2)*sin(theta6/2))/80 + (3*cos(theta3/2)*cos(theta5/2)*cos(theta6/2)*sin(theta1/2)*sin(theta2/2)*sin(theta4/2))/80 - (39*cos(theta1/2)*cos(theta2/2)*sin(theta3/2)*sin(theta4/2)*sin(theta5/2)*sin(theta6/2))/400 + (9*cos(theta1/2)*cos(theta3/2)*sin(theta2/2)*sin(theta4/2)*sin(theta5/2)*sin(theta6/2))/80 + (39*cos(theta1/2)*cos(theta5/2)*sin(theta2/2)*sin(theta3/2)*sin(theta4/2)*sin(theta6/2))/400 + (39*cos(theta2/2)*cos(theta4/2)*sin(theta1/2)*sin(theta3/2)*sin(theta5/2)*sin(theta6/2))/400 - (39*cos(theta2/2)*cos(theta6/2)*sin(theta1/2)*sin(theta3/2)*sin(theta4/2)*sin(theta5/2))/400 - (9*cos(theta3/2)*cos(theta4/2)*sin(theta1/2)*sin(theta2/2)*sin(theta5/2)*sin(theta6/2))/80 + (9*cos(theta3/2)*cos(theta6/2)*sin(theta1/2)*sin(theta2/2)*sin(theta4/2)*sin(theta5/2))/80 + (39*cos(theta4/2)*cos(theta5/2)*sin(theta1/2)*sin(theta2/2)*sin(theta3/2)*sin(theta6/2))/400 + (39*cos(theta5/2)*cos(theta6/2)*sin(theta1/2)*sin(theta2/2)*sin(theta3/2)*sin(theta4/2))/400 - (3*cos(theta1/2)*sin(theta2/2)*sin(theta3/2)*sin(theta4/2)*sin(theta5/2)*sin(theta6/2))/80 + (3*cos(theta4/2)*sin(theta1/2)*sin(theta2/2)*sin(theta3/2)*sin(theta5/2)*sin(theta6/2))/80 - (3*cos(theta6/2)*sin(theta1/2)*sin(theta2/2)*sin(theta3/2)*sin(theta4/2)*sin(theta5/2))/80;

x_e_conj = [x_e(1); -x_e(2:4); x_e(5); -x_e(6:8)];

C = diag([1 -1 -1 -1]);

JD = .5*hemi4minus(x_e_conj(1:4))' * (Jp - 2*hemi4plus(x_e(5:8))*C*JP);

%%

J = [JP;JD];

A = zeros(14, 14);
Bmv = [J; eye(6)];
end

