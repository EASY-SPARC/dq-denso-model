%% Load Parameters
syms theta1 theta2 theta3 theta4 theta5 theta6
syms placeholder

thetas = [theta1 theta2 theta3 theta4 theta5 theta6];

denso_DH_theta=  [0,pi/2,-pi/2,0,0,0];
denso_DH_d =     [0.125,0,0,0.210,0,0.070];
denso_DH_a =     [0,0.210, -0.075, 0, 0,0];
denso_DH_alpha = [pi/2,0,-pi/2, pi/2,-pi/2,0];

r_z_thetas = [];
p_z_ds = [];
p_x_as = [];
r_x_alphas = [];
x = [];

%% Primal Jacobian (JP)

JP = placeholder*ones(4,6);

JP(1,:) = [ sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + sin(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, sin(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + sin(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8];
JP(2,:) = [ sin(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, sin(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 + sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 + sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 - sin(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - sin(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8];
JP(3,:) = [ cos(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, cos(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8, cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 - theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8];
JP(4,:) = [ cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, cos(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, cos(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, cos(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 - cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8, cos(theta2/2 - theta1/2 + theta3/2 + theta4/2 + theta5/2 - theta6/2)/8 - cos(theta1/2 - theta2/2 - theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 - theta2/2 - theta3/2 + theta4/2 + theta5/2 + theta6/2)/8 - cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 - theta4/2 + theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 - theta5/2 + theta6/2)/8 + cos(theta1/2 + theta2/2 + theta3/2 + theta4/2 + theta5/2 + theta6/2)/8];

%% Position Jacobian (Jp)

Jp = placeholder*ones(3,6);

Jp(1,1) = 0.21*sin(theta1)*sin(theta2) + 0.21*cos(theta2)*sin(theta1)*sin(theta3) + 0.21*cos(theta3)*sin(theta1)*sin(theta2) + 0.07*cos(theta1)*sin(theta4)*sin(theta5) - 0.075*sin(theta1)*sin(theta2)*sin(theta3) + 0.075*cos(theta2)*cos(theta3)*sin(theta1) + 0.07*cos(theta2)*cos(theta5)*sin(theta1)*sin(theta3) + 0.07*cos(theta3)*cos(theta5)*sin(theta1)*sin(theta2) + 0.07*cos(theta2)*cos(theta3)*cos(theta4)*sin(theta1)*sin(theta5) - 0.07*cos(theta4)*sin(theta1)*sin(theta2)*sin(theta3)*sin(theta5);
Jp(2,1) = - 0.21*cos(theta1)*sin(theta2) + 0.075*cos(theta1)*sin(theta2)*sin(theta3) + 0.07*sin(theta1)*sin(theta4)*sin(theta5) - 0.075*cos(theta1)*cos(theta2)*cos(theta3) - 0.21*cos(theta1)*cos(theta2)*sin(theta3) - 0.21*cos(theta1)*cos(theta3)*sin(theta2) - 0.07*cos(theta1)*cos(theta2)*cos(theta5)*sin(theta3) - 0.07*cos(theta1)*cos(theta3)*cos(theta5)*sin(theta2) - 0.07*cos(theta1)*cos(theta2)*cos(theta3)*cos(theta4)*sin(theta5) + 0.07*cos(theta1)*cos(theta4)*sin(theta2)*sin(theta3)*sin(theta5);

Jp(1,2) = - 0.1115*cos(theta2 - 1.0*theta1 + theta3 + 0.34302)- 0.00875*cos(theta1 + theta2 + theta3 + theta4 + theta5) - 0.0175*cos(theta1 + theta2 + theta3 - 1.0*theta5) - 0.0175*cos(theta2 - 1.0*theta1 + theta3 + theta5) + 0.00875*cos(theta1 + theta2 + theta3 - 1.0*theta4 - 1.0*theta5) + 0.00875*cos(theta1 - 1.0*theta2 - 1.0*theta3 + theta4 + theta5) + 0.00875*cos(theta2 - 1.0*theta1 + theta3 + theta4 - 1.0*theta5) - 0.00875*cos(theta2 - 1.0*theta1 + theta3 - 1.0*theta4 + theta5) - 0.105*cos(theta1 - 1.0*theta2) - 0.1115*cos(theta1 + theta2 + theta3 + 0.34302)- 0.0175*cos(theta1 + theta2 + theta3 + theta5) + 0.00875*cos(theta1 + theta2 + theta3 + theta4 - 1.0*theta5) - 0.00875*cos(theta1 + theta2 + theta3 - 1.0*theta4 + theta5) - 0.00875*cos(theta2 - 1.0*theta1 + theta3 + theta4 + theta5) - 0.105*cos(theta1 + theta2) - 0.0175*cos(theta1 - 1.0*theta2 - 1.0*theta3 + theta5);
Jp(2,2) = 0.0175*sin(theta2 - 1.0*theta1 + theta3 + theta5) - 0.0175*sin(theta1 + theta2 + theta3 - 1.0*theta5) - 0.00875*sin(theta1 + theta2 + theta3 + theta4 + theta5) + 0.00875*sin(theta1 + theta2 + theta3 - 1.0*theta4 - 1.0*theta5) + 0.00875*sin(theta1 - 1.0*theta2 - 1.0*theta3 + theta4 + theta5) - 0.00875*sin(theta2 - 1.0*theta1 + theta3 + theta4 - 1.0*theta5) + 0.00875*sin(theta2 - 1.0*theta1 + theta3 - 1.0*theta4 + theta5) - 0.105*sin(theta1 - 1.0*theta2) - 0.1115*cos(theta1 + theta2 + theta3 - 1.2278) - 0.0175*sin(theta1 + theta2 + theta3 + theta5) + 0.1115*cos(theta1 - 1.0*theta2 - 1.0*theta3 + 1.2278) + 0.00875*sin(theta1 + theta2 + theta3 + theta4 - 1.0*theta5) - 0.00875*sin(theta1 + theta2 + theta3 - 1.0*theta4 + theta5) + 0.00875*sin(theta2 - 1.0*theta1 + theta3 + theta4 + theta5) - 0.105*sin(theta1 + theta2)- 0.0175*sin(theta1 - 1.0*theta2 - 1.0*theta3 + theta5);
Jp(3,2) = - 0.035*sin(theta2 + theta3 + theta5) + 0.0175*sin(theta2 + theta3 + theta4 - 1.0*theta5) - 0.0175*sin(theta2 + theta3 - 1.0*theta4 + theta5) - 0.0175*sin(theta2 + theta3 + theta4 + theta5) - 0.035*sin(theta2 + theta3 - 1.0*theta5) + 0.0175*sin(theta2 + theta3 - 1.0*theta4 - 1.0*theta5) - 0.21*sin(theta2) - 0.22299*cos(theta2 + theta3 - 1.2278);

Jp(1,3) = - 0.1115*cos(theta2 - 1.0*theta1 + theta3 + 0.34302)- 0.00875*cos(theta1 + theta2 + theta3 + theta4 + theta5) - 0.0175*cos(theta1 + theta2 + theta3 - 1.0*theta5) - 0.0175*cos(theta2 - 1.0*theta1 + theta3 + theta5) + 0.00875*cos(theta1 + theta2 + theta3 - 1.0*theta4 - 1.0*theta5) + 0.00875*cos(theta1 - 1.0*theta2 - 1.0*theta3 + theta4 + theta5) + 0.00875*cos(theta2 - 1.0*theta1 + theta3 + theta4 - 1.0*theta5) - 0.00875*cos(theta2 - 1.0*theta1 + theta3 - 1.0*theta4 + theta5) - 0.1115*cos(theta1 + theta2 + theta3 + 0.34302) - 0.0175*cos(theta1 + theta2 + theta3 + theta5) + 0.00875*cos(theta1 + theta2 + theta3 + theta4 - 1.0*theta5) - 0.00875*cos(theta1 + theta2 + theta3 - 1.0*theta4 + theta5) - 0.00875*cos(theta2 - 1.0*theta1 + theta3 + theta4 + theta5) - 1.0716e-18*cos(theta1 - 1.0*theta2 - 1.0*theta3 + theta4) - 0.0175*cos(theta1 - 1.0*theta2 - 1.0*theta3 + theta5);
Jp(2,3) = 0.0175*sin(theta2 - 1.0*theta1 + theta3 + theta5) - 0.0175*sin(theta1 + theta2 + theta3 - 1.0*theta5) - 0.00875*sin(theta1 + theta2 + theta3 + theta4 + theta5) + 0.00875*sin(theta1 + theta2 + theta3 - 1.0*theta4 - 1.0*theta5) + 0.00875*sin(theta1 - 1.0*theta2 - 1.0*theta3 + theta4 + theta5) - 0.00875*sin(theta2 - 1.0*theta1 + theta3 + theta4 - 1.0*theta5) + 0.00875*sin(theta2 - 1.0*theta1 + theta3 - 1.0*theta4 + theta5) - 0.1115*cos(theta1 + theta2 + theta3 - 1.2278) - 0.0175*sin(theta1 + theta2 + theta3 + theta5) + 0.1115*cos(theta1 - 1.0*theta2 - 1.0*theta3 + 1.2278) + 0.00875*sin(theta1 + theta2 + theta3 + theta4 - 1.0*theta5) - 0.00875*sin(theta1 + theta2 + theta3 - 1.0*theta4 + theta5) + 0.00875*sin(theta2 - 1.0*theta1 + theta3 + theta4 + theta5) - 0.0175*sin(theta1 - 1.0*theta2 - 1.0*theta3 + theta5);
Jp(3,3) = - 0.035*sin(theta2 + theta3 + theta5) + 0.0175*sin(theta2 + theta3 + theta4 - 1.0*theta5) - 0.0175*sin(theta2 + theta3 - 1.0*theta4 + theta5) - 0.0175*sin(theta2 + theta3 + theta4 + theta5) - 0.035*sin(theta2 + theta3 - 1.0*theta5) + 0.0175*sin(theta2 + theta3 - 1.0*theta4 - 1.0*theta5) - 0.22299*cos(theta2 + theta3 - 1.2278);

Jp(1,4) = - 0.0175*cos(theta1 + theta4 + theta5) - 0.00875*cos(theta1 + theta2 + theta3 + theta4 + theta5) - 0.00875*cos(theta1 + theta2 + theta3 - 1.0*theta4 - 1.0*theta5) - 0.00875*cos(theta1 - 1.0*theta2 - 1.0*theta3 + theta4 + theta5) + 0.00875*cos(theta2 - 1.0*theta1 + theta3 + theta4 - 1.0*theta5) + 0.00875*cos(theta2 - 1.0*theta1 + theta3 - 1.0*theta4 + theta5) + 0.00875*cos(theta1 + theta2 + theta3 + theta4 - 1.0*theta5) + 0.00875*cos(theta1 + theta2 + theta3 - 1.0*theta4 + theta5) - 0.00875*cos(theta2 - 1.0*theta1 + theta3 + theta4 + theta5) + 0.0175*cos(theta1 + theta4 - 1.0*theta5) - 0.0175*cos(theta1 - 1.0*theta4 + theta5) + 0.0175*cos(theta4 - 1.0*theta1 + theta5);
Jp(2,4) = - 0.0175*sin(theta1 + theta4 + theta5) - 0.00875*sin(theta1 + theta2 + theta3 + theta4 + theta5) - 0.00875*sin(theta1 + theta2 + theta3 - 1.0*theta4 - 1.0*theta5) - 0.00875*sin(theta1 - 1.0*theta2 - 1.0*theta3 + theta4 + theta5) - 0.00875*sin(theta2 - 1.0*theta1 + theta3 + theta4 - 1.0*theta5) - 0.00875*sin(theta2 - 1.0*theta1 + theta3 - 1.0*theta4 + theta5) + 0.00875*sin(theta1 + theta2 + theta3 + theta4 - 1.0*theta5) + 0.00875*sin(theta1 + theta2 + theta3 - 1.0*theta4 + theta5) + 0.00875*sin(theta2 - 1.0*theta1 + theta3 + theta4 + theta5) + 0.0175*sin(theta1 + theta4 - 1.0*theta5) - 0.0175*sin(theta1 - 1.0*theta4 + theta5) - 0.0175*sin(theta4 - 1.0*theta1 + theta5);
Jp(3,4) = 0.0175*sin(theta2 + theta3 + theta4 - 1.0*theta5) + 0.0175*sin(theta2 + theta3 - 1.0*theta4 + theta5) - 0.0175*sin(theta2 + theta3 + theta4 + theta5) - 0.0175*sin(theta2 + theta3 - 1.0*theta4 - 1.0*theta5);

Jp(1,5) = 0.0175*cos(theta1 + theta2 + theta3 - 1.0*theta5) - 0.0175*cos(theta1 + theta4 + theta5) - 0.00875*cos(theta1 + theta2 + theta3 + theta4 + theta5) - 0.0175*cos(theta2 - 1.0*theta1 + theta3 + theta5) - 0.00875*cos(theta1 + theta2 + theta3 - 1.0*theta4 - 1.0*theta5) - 0.00875*cos(theta1 - 1.0*theta2 - 1.0*theta3 + theta4 + theta5) - 0.00875*cos(theta2 - 1.0*theta1 + theta3 + theta4 - 1.0*theta5) - 0.00875*cos(theta2 - 1.0*theta1 + theta3 - 1.0*theta4 + theta5) - 0.0175*cos(theta1 + theta2 + theta3 + theta5) - 0.00875*cos(theta1 + theta2 + theta3 + theta4 - 1.0*theta5) - 0.00875*cos(theta1 + theta2 + theta3 - 1.0*theta4 + theta5) - 0.00875*cos(theta2 - 1.0*theta1 + theta3 + theta4 + theta5) - 0.0175*cos(theta1 + theta4 - 1.0*theta5) + 0.0175*cos(theta1 - 1.0*theta4 + theta5) + 0.0175*cos(theta4 - 1.0*theta1 + theta5) + 0.0175*cos(theta1 - 1.0*theta2 - 1.0*theta3 + theta5);
Jp(2,5) = 0.0175*sin(theta1 + theta2 + theta3 - 1.0*theta5) - 0.0175*sin(theta1 + theta4 + theta5) - 0.00875*sin(theta1 + theta2 + theta3 + theta4 + theta5) + 0.0175*sin(theta2 - 1.0*theta1 + theta3 + theta5) - 0.00875*sin(theta1 + theta2 + theta3 - 1.0*theta4 - 1.0*theta5) - 0.00875*sin(theta1 - 1.0*theta2 - 1.0*theta3 + theta4 + theta5) + 0.00875*sin(theta2 - 1.0*theta1 + theta3 + theta4 - 1.0*theta5) + 0.00875*sin(theta2 - 1.0*theta1 + theta3 - 1.0*theta4 + theta5) - 0.0175*sin(theta1 + theta2 + theta3 + theta5) - 0.00875*sin(theta1 + theta2 + theta3 + theta4 - 1.0*theta5) - 0.00875*sin(theta1 + theta2 + theta3 - 1.0*theta4 + theta5) + 0.00875*sin(theta2 - 1.0*theta1 + theta3 + theta4 + theta5) - 0.0175*sin(theta1 + theta4 - 1.0*theta5) + 0.0175*sin(theta1 - 1.0*theta4 + theta5) - 0.0175*sin(theta4 - 1.0*theta1 + theta5) + 0.0175*sin(theta1 - 1.0*theta2 - 1.0*theta3 + theta5);
Jp(3,5) = - 0.0175*sin(theta2 + theta3 + theta4 - 1.0*theta5) - 0.0175*sin(theta2 + theta3 - 1.0*theta4 + theta5) - 0.035*sin(theta2 + theta3 + theta5) - 0.0175*sin(theta2 + theta3 + theta4 + theta5) + 0.035*sin(theta2 + theta3 - 1.0*theta5) - 0.0175*sin(theta2 + theta3 - 1.0*theta4 - 1.0*theta5);

Jp = [zeros(1,6);Jp];
Jp = subs(Jp, placeholder, 0);

%% Dual Jacobian

r_z_thetas = [];
p_z_ds = [];
p_x_as = [];
r_x_alphas = [];
x = [];

for i = 1:6
    r_z_thetas = [r_z_thetas q_rotation_z(thetas(i) + denso_DH_theta(i))];
    p_z_ds = [p_z_ds q_translation_z(denso_DH_d(i))];
    p_x_as = [p_x_as q_translation_x(denso_DH_a(i))];
    r_x_alphas = [r_x_alphas q_rotation_x(denso_DH_alpha(i))];
    
    x_i = hemi8plus(r_z_thetas(:,i)) * p_z_ds(:,i);
    x_i = hemi8plus(x_i) * p_x_as(:,i);
    x_i = hemi8plus(x_i) * r_x_alphas(:,i);
    
    x = [x x_i];
end

x_0_i = x(:,1);

for i = 2:6
    x_0_i = [x_0_i hemi8plus(x_0_i(:,i-1))*x(:,i)];
end

x_e = x_0_i(:,6);
x_e = simplify(x_e);
x_e_conj = [x_e(1); -x_e(2:4); x_e(5); -x_e(6:8)];

C = diag([1 -1 -1 -1]);

therm_1 = .5*hemi4minus(x_e_conj(1:4))';
therm_2 = (Jp - 2*hemi4plus(x_e(5:8))*C*JP);

therm_1 = simplify(therm_1);
therm_2 = simplify(therm_2);

JD = therm_1 * therm_2;

JD = simplify(JD)
